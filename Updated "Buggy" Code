#order_management.py
import unittest

class Order:
    def __init__(self, customer_name, items):
        self.customer_name = customer_name
        self.items = items  

    def calculate_total(self):
        total = 0
        for item in self.items:
            total += item[1] * item[2]  
        if total == 0:  
            return "Empty Order"
        return total

    def add_item(self, item_name, quantity, price):
        self.items.append((item_name, quantity, price))  

    def remove_item(self, item_name):
        for item in self.items[:]:  
            if item[0] == item_name:
                self.items.remove(item)  

    def gross_print_summary(self):
        print("Order Summary for", self.customer_name)
        for item in self.items: 
            print(f"{item[1]} x {item[0]} @ ${item[2]:.2f}")
        print(f"Total: $ {self.calculate_total():.2f}")

    def apply_discount(self, code): 
        if code == "SAVE10":
            return 0.1
        elif code == "SAVE20":
            return 0.2
        elif code == "SAVE30":
            return 0.3

class TestOrder(unittest.TestCase):
    def setUp(self):
        self.order = Order("Test", [("Book", 2, 15.00), ("Pen", 5, 1.50)])

    def test_calculate_total(self):
        self.assertEqual(self.order.calculate_total(), 37.5)

    def test_valid_discount(self):
        self.assertEqual(self.order.apply_discount("SAVE10"), 0.1)

    def test_invalid_discount(self):
        self.assertIsNone(self.order.apply_discount("FAKE CODE"))
  
    def test_remove_item(self):
        self.order.remove_item("Pen")
        self.assertEqual(len(self.order.items), 1)
        self.assertEqual(self.order.items[0][0], "Book")

def main():
    order = Order("Alice", [("Book", 2, 15.00), ("Pen", 5, 1.50)])
    order.add_item("Notebook", 3, 5.00)
    order.remove_item("Pen")
    order.gross_print_summary() 
    user_code = input("Enter code: ")
    discount = order.apply_discount(user_code)
    total_before_discount = order.calculate_total()
    if discount: 
        printed_discount = total_before_discount * discount
        total_after_discount = total_before_discount - printed_discount
        print("Discount rate: ", discount, f"\nTotal after discount: ${total_after_discount:.2f}")
    else:
        print(f"Invalid discount code. Total remains: ${total_before_discount:.2f}")

if __name__ == "__main__":
    main() 
